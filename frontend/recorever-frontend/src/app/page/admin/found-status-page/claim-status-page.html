<div class="claim-management-container">
  <header class="page-header">
    <h1 class="page-title">Found Status Management</h1>

    <div class="search-wrapper">
      <app-search-bar (search)="onSearch($event)"></app-search-bar>
    </div>

    <div class="status-filter-wrapper">
      <label for="status-filter">Status:</label>
      <select id="status-filter"
              #statusSelect
              [value]="currentStatusFilter()"
              (change)="setStatusFilter(statusSelect.value)">
        @for (status of statusFilters; track status) {
          <option [value]="status">
            {{ status | titlecase }}
          </option>
        }
      </select>
    </div>
  </header>

  <div class="filter-section" style="margin-bottom: 1rem;">
    <app-filter
      [locations]="locations()"
      [itemType]="'found'"
      (filterChange)="onFilterChange($event)">
    </app-filter>
  </div>

  <div class="claims-list">
    @if (reports().length > 0) {
      <app-report-item-grid
            [items]="filteredReports()"
            [isAdmin]="isAdmin()"
            (cardClicked)="onViewDetails($event.report_id)">
      </app-report-item-grid>
    }

    <div #scrollAnchor class="scroll-anchor">
      @if (isLoading()) {
        <div class="status-message">
          <div class="spinner"></div>
          <span>Loading more reports...</span>
        </div>
      } @else if (reports().length === 0) {
        <div class="status-message empty-state">No reports found.</div>
      } @else if (currentPage() >= totalPages()) {
        <div class="status-message end-state">No more reports to display.</div>
      }
    </div>
  </div>

  @if (selectedReport()) {
    <app-claim-form-modal
        [claimData]="selectedReport()!"
        (close)="onCloseModal()"
        (statusChange)="onStatusChanged($event)">
    </app-claim-form-modal>
  }
</div>